<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§é“åœ‹ä¸­ - åˆé¤è³‡è¨Šç¶²</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary-pink: #FFB6C1;
            --light-pink: #FFE4E9;
            --soft-yellow: #FFD700;
            --light-blue: #87CEFA;
            --lavender: #D8BFD8;
            --mint-green: #98FB98;
            --text-color: #333;
            --light-bg: #FFF0F5;
            --card-bg: #FFF;
            --border-radius: 20px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Comic Sans MS', 'YuGothic', 'Hiragino Sans GB', sans-serif;
        }

        body {
            background-color: var(--light-bg);
            color: var(--text-color);
            line-height: 1.6;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><circle cx="20" cy="20" r="5" fill="%23FFB6C1" opacity="0.2"/><circle cx="50" cy="50" r="8" fill="%2387CEFA" opacity="0.2"/><circle cx="80" cy="80" r="6" fill="%23FFD700" opacity="0.2"/></svg>');
            padding-top: 0;
         }

        /* é ‚éƒ¨è·‘é¦¬ç‡ˆ */
        .marquee-container {
            background: linear-gradient(135deg, var(--primary-pink), var(--lavender));
            padding: 12px 0;
            overflow: hidden;
            border-bottom: 3px solid white;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .marquee {
            display: inline-block;
            white-space: nowrap;
            animation: marquee 25s linear infinite;
            padding-left: 100%;
        }

        @keyframes marquee {
            0% { transform: translate(0, 0); }
            100% { transform: translate(-100%, 0); }
        }

        /* å°è¦½åˆ— */
        nav {
            background: linear-gradient(135deg, var(--light-blue), var(--mint-green));
            padding: 15px 0;
            border-bottom: 3px solid white;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .nav-item {
            background-color: white;
            padding: 10px 20px;
            border-radius: 30px;
            text-decoration: none;
            color: var(--text-color);
            font-weight: bold;
            display: flex;
            align-items: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .nav-item i {
            margin-right: 8px;
            color: var(--primary-pink);
        }

        .nav-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
            background-color: var(--light-pink);
        }

        /* é¦–é èƒŒæ™¯èˆ‡å…§å®¹ */
        .homepage {
            min-height: 500px;
            background: url('https://images.unsplash.com/photo-1523050854058-8df90110c9f1?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1200&q=80') no-repeat center center;
            background-size: cover;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
            text-align: center;
        }

        .homepage::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.7);
        }

        .school-name {
            font-size: 3rem;
            color: #D3A4FF;
            margin-bottom: 20px;
            position: relative;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .welcome-message {
            font-size: 1.5rem;
            margin-bottom: 40px;
            position: relative;
            color: #555;
        }

        .function-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            max-width: 1000px;
            width: 100%;
            position: relative;
        }

        .function-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 25px;
            text-align: center;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .function-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.15);
        }

        .function-card i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--primary-pink);
        }

        .function-card h3 {
            margin-bottom: 10px;
            color: var(--text-color);
        }

        .function-card p {
            color: #666;
            font-size: 0.9rem;
        }

        /* é é¢å…§å®¹å€åŸŸ */
        .page-content {
            display: none;
            padding: 40px 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .page-title {
            text-align: center;
            margin-bottom: 30px;
            color: var(--primary-pink);
            font-size: 2.2rem;
            position: relative;
        }

        .page-title:after {
            content: "";
            display: block;
            width: 100px;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-pink), var(--light-blue));
            margin: 10px auto;
            border-radius: 2px;
        }

        .vendor-section {
            background-color: #ffffff;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.05);
        }
        
        .vendor-section h3 {
            font-size: 1.8rem;
            color: #4A4A4A;
            text-align: center;
            margin-bottom: 20px;
            font-weight: bold;
        }

        /* èœå–®è¡¨æ ¼ */
        .menu-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .menu-table th, .menu-table td {
            border: 1px solid var(--light-pink);
            padding: 12px 15px;
            text-align: center;
        }

        .menu-table th {
            background-color: var(--light-pink);
            color: var(--text-color);
        }

        .menu-table tr:nth-child(even) {
            background-color: #FFF8F8;
        }

        /* ä¸Šå‚³å€åŸŸ */
        .upload-area {
            border: 3px dashed var(--light-blue);
            border-radius: var(--border-radius);
            padding: 30px;
            text-align: center;
            margin: 30px 0;
            background-color: rgba(135, 206, 250, 0.1);
            transition: all 0.3s;
            cursor: pointer;
        }

        .upload-area:hover {
            background-color: rgba(135, 206, 250, 0.2);
            border-color: var(--primary-pink);
        }

        .upload-note {
            font-size: 0.9rem;
            color: #777;
            margin-top: 10px;
        }

        /* ç›¸ç°¿æ¨£å¼ */
        .photo-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .photo-item {
            height: 200px;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .photo-item:hover img {
            transform: scale(1.1);
        }

        /* å½±ç‰‡å®¹å™¨ */
        .video-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            margin: 20px 0;
            border-radius: var(--border-radius);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        /* æª”æ¡ˆåˆ—è¡¨ */
        .file-list {
            margin: 20px 0;
        }

        .file-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background-color: white;
            border-radius: 12px;
            margin-bottom: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            transition: all 0.2s;
        }

        .file-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 12px rgba(0, 0, 0, 0.12);
        }

        .file-item i {
            margin-right: 15px;
            font-size: 1.8rem;
            color: var(--light-blue);
        }

        /* æŒ‰éˆ•æ¨£å¼ */
        .survey-button {
            display: inline-block;
            background: linear-gradient(135deg, var(--primary-pink), var(--light-blue));
            color: white;
            padding: 15px 30px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: bold;
            font-size: 1.2rem;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
            transition: all 0.3s;
        }

        .survey-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        /* è£é£¾å…ƒç´  */
        .decoration {
            position: fixed;
            z-index: -1;
            opacity: 0.15;
            font-size: 5rem;
        }

        .rice-ball {
            top: 15%;
            left: 5%;
            transform: rotate(15deg);
        }

        .animal {
            bottom: 10%;
            right: 5%;
            transform: rotate(-10deg);
        }

        .curry-rice{
            bottom: 10%;
            right: 40%;
            transform: rotate(-10deg);
        }

        .koala{
            bottom: 10%;
            left: 60%;
            transform: rotate(20deg);
        }

        .sloth{
            bottom: 10%;
            right: 5%;
            transform: rotate(-40deg);
        }

        /* é å°¾ */
        footer {
            text-align: center;
            padding: 20px;
            color: #888;
            font-size: 0.8rem;
        }


        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 768px) {
            .school-name {
                font-size: 2.2rem;
            }

            .welcome-message {
                font-size: 1.2rem;
            }

            .function-grid {
                grid-template-columns: 1fr;
            }

            .nav-container {
                flex-direction: column;
                align-items: center;
            }

            .nav-item {
                width: 80%;
                justify-content: center;
                margin-bottom: 8px;
            }

            .photo-gallery {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }

            .photo-item {
                height: 150px;
            }
        }

        /* è‡ªè¨‚è¨Šæ¯è¦–çª—æ¨£å¼ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            visibility: hidden;
            opacity: 0;
            transition: visibility 0s, opacity 0.3s ease;
        }

        .modal-overlay.visible {
            visibility: visible;
            opacity: 1;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }

        .modal-overlay.visible .modal-content {
            transform: scale(1);
        }

        .modal-content h3 {
            color: var(--primary-pink);
            font-size: 1.5rem;
            margin-bottom: 15px;
        }

        .modal-content p {
            color: var(--text-color);
            margin-bottom: 25px;
        }

        .modal-content button {
            background: linear-gradient(135deg, var(--primary-pink), var(--light-blue));
            border: none;
            color: white;
            padding: 10px 25px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1rem;
            transition: transform 0.2s;
        }

        .modal-content button:hover {
            transform: translateY(-2px);
        }

        /* å…¬å‘Šå®¹å™¨æ ·å¼ */
        .announcements-container {
            background-color: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.05);
            margin-top: 30px;
            overflow: hidden;
        }

        /* å…¬å‘Šæ ‡é¢˜æ  */
        .announcement-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            position: relative;
        }

        .header-icon {
            width: 40px;
            height: 40px;
            background-color: #FFB6C1;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .header-icon i {
            color: white;
            font-size: 1.2rem;
        }

        .announcement-header h3 {
            font-size: 1.5rem;
            color: #211e1e;
            margin: 0;
        }

        .header-decoration {
            flex-grow: 1;
            height: 2px;
            background: linear-gradient(90deg, #FFB6C1, transparent);
            margin-left: 15px;
        }

        /* å…¬å‘Šåˆ—è¡¨ */
        .announcement-list {
            margin-bottom: 15px;
        }

        /* å…¬å‘Šé¡¹ */
        .announcement-item {
            padding: 12px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px dashed #f0f0f0;
            transition: background-color 0.2s;
        }

        .announcement-item:last-child {
            border-bottom: none;
        }

        .announcement-item:hover {
            background-color: #FFF8F9;
        }

        .announcement-content {
            display: flex;
            align-items: center;
            max-width: 80%;
        }

        .announcement-dot {
            width: 8px;
            height: 8px;
            background-color: #FFB6C1;
            border-radius: 50%;
            margin-right: 10px;
            flex-shrink: 0;
        }

        .announcement-item span:first-of-type {
            color: #333;
            line-height: 1.5;
        }

        .announcement-date {
            color: #999;
            font-size: 0.9rem;
            white-space: nowrap;
            padding-left: 15px;
        }

        /* æŸ¥çœ‹æ›´å¤šæŒ‰é’® */
        .announcement-more {
            text-align: right;
            padding-top: 10px;
        }

        .more-link {
            color: #FFB6C1;
            text-decoration: none;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            transition: all 0.3s;
        }

        .more-link:hover {
            color: #FF8FA3;
            transform: translateX(3px);
        }

        .more-link i {
            font-size: 0.8rem;
            margin-left: 5px;
            transition: transform 0.3s;
        }

        .more-link:hover i {
            transform: translateX(3px);
        }

        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 768px) {
            .announcement-item {
                flex-direction: column;
                align-items: flex-start;
                padding: 15px 0;
            }
            
            .announcement-date {
                padding-left: 18px;
                margin-top: 5px;
                font-size: 0.8rem;
                color: #bbb;
            }
            
            .announcement-content {
                max-width: 100%;
            }
        }

        /* å» å•†èœå–®ç›¸é—œæ¨£å¼ */
        .file-input {
            display: none;
        }

        .btn-export {
            display: none;
            margin-top: 1rem;
            padding: 0.75rem 1.5rem;
            background-color: #4CAF50;
            color: white;
            border-radius: 0.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .btn-export:hover {
            background-color: #45a049;
        }

        .table-container {
            margin-top: 2rem;
            overflow-x: auto;
        }

        .excel-table {
            width: 100%;
            border-collapse: collapse;
        }

        .excel-table th, .excel-table td {
            padding: 12px 15px;
            border: 1px solid #e5e7eb;
            text-align: left;
        }

        .excel-table thead th {
            background-color: #f3f4f6;
            font-weight: bold;
        }

        .excel-table tbody tr:nth-child(even) {
            background-color: #f9fafb;
        }

        .login-status {
            text-align: right;
            margin-bottom: 20px;
            font-weight: bold;
            color: #555;
        }

        .login-form-group {
            margin-bottom: 15px;
            text-align: left;
        }
        .login-form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .login-form-group input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        #loginError {
            color: #ff0000;
            display: none;
            margin-top: 10px;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="decoration rice-ball">ğŸ™</div>
    <div class="decoration animal">ğŸ°</div>
    <div class="decoration curry-rice">ğŸ›</div>
    <div class="decoration koala">ğŸ¨</div>
    <div class="decoration sloth">ğŸ¦¥</div>

    <div class="marquee-container">
        <div class="marquee">
            ğŸ‰ æ­¡è¿ä¾†åˆ°å¤§é“åœ‹ä¸­åˆé¤ç¶²ç«™ ğŸ‰ &nbsp;&nbsp;|&nbsp;&nbsp;
            ğŸ“¢ æé†’ï¼šä¸‹é€±ä¸€é€²è¡Œå»šæˆ¿æ¸…æ½”ï¼Œä¾›é¤æ™‚é–“èª¿æ•´ç‚º12:10 ğŸ“¢ &nbsp;&nbsp;|&nbsp;&nbsp;
            ğŸŒŸ ç‡Ÿé¤Šå°çŸ¥è­˜ï¼šæ¯å¤©æ”å–äº”ç¨®ä¸åŒé¡è‰²çš„è”¬æœï¼Œå¥åº·æ»¿åˆ†ï¼ ğŸŒŸÙ©(â—•â€¿â—•)Û¶
        </div>
    </div>

    <nav>
        <div class="nav-container">
            <a href="#" class="nav-item" onclick="showPage('home')"><i class="fas fa-home"></i> é¦–é </a>
            <a href="#" class="nav-item" onclick="showPage('menu')"><i class="fas fa-utensils"></i> å» å•†èœå–®</a>
            <a href="#" class="nav-item" onclick="showPage('survey')"><i class="fas fa-clipboard-list"></i> æ»¿æ„åº¦èª¿æŸ¥</a>
            <a href="#" class="nav-item" onclick="showPage('gallery')"><i class="fas fa-camera"></i> æ´»å‹•ç…§ç‰‡</a>
            <a href="#" class="nav-item" onclick="showPage('education')"><i class="fas fa-apple-alt"></i> ç‡Ÿé¤Šæ•™è‚²</a>
            <a href="#" class="nav-item" onclick="showPage('subsidy')"><i class="fas fa-file-contract"></i> è£œåŠ©ç”³è«‹</a>
            <a href="#" class="nav-item" onclick="showPage('finance')"><i class="fas fa-calculator"></i> æ”¶æ”¯çµç®—</a>
            <a href="#" class="nav-item" onclick="showPage('lunch-coupon')"><i class="fas fa-ticket-alt"></i> å®‰å¿ƒåˆé¤åˆ¸</a>
        </div>
    </nav>

    <div id="home" class="page-content">
        <div class="homepage">
            <h1 class="school-name">å¤§é“åœ‹ä¸­ (Â´ï½¡â€¢ áµ• â€¢ï½¡`)</h1>
            <p class="welcome-message">æ­¡è¿ä½¿ç”¨åˆé¤è³‡è¨Šç³»çµ±ï¼Œè«‹é¸æ“‡æ‚¨éœ€è¦çš„æœå‹™Ù©ê’°ï½¡â€¢â—¡â€¢ï½¡ê’±Û¶</p>
            <div class="function-grid">
                <div class="function-card" onclick="showPage('menu')">
                    <i class="fas fa-utensils"></i>
                    <h3>å» å•†èœå–®</h3>
					<p>æä¾›æœ€æ–°çš„å­¸æ ¡åˆé¤èœå–®ï¼Œè®“å®¶é•·å’Œå­¸ç”Ÿäº†è§£æ¯æ—¥ç‡Ÿé¤Šæ”å–ç‹€æ³(*^â–½^*)ã€‚</p>
                    <p>æŸ¥çœ‹æ¯æ—¥ç‡Ÿé¤Šåˆé¤èœå–®èˆ‡ç†±é‡è³‡è¨Š</p>
                </div>
                <div class="function-card" onclick="showPage('survey')">
                    <i class="fas fa-clipboard-list"></i>
                    <h3>æ»¿æ„åº¦èª¿æŸ¥</h3>
                    <p>è«‹é»æ“Šä¸‹æ–¹æŒ‰éˆ•å¡«å¯«æœ¬é€±çš„åˆé¤æ»¿æ„åº¦å•å·ï¼Œæ‚¨çš„æ„è¦‹å°æˆ‘å€‘éå¸¸é‡è¦ï¼çš„åˆé¤æ»¿æ„åº¦å•å·ï¼Œæ‚¨çš„æ„è¦‹å°æˆ‘å€‘éå¸¸é‡è¦ï¼ à¸…^â€¢Ï‰â€¢^à¸…</p>
                </div>
                <div class="function-card" onclick="showPage('gallery')">
                    <i class="fas fa-camera"></i>
                    <h3>æ´»å‹•ç…§ç‰‡</h3>
                    <p>ç€è¦½åˆé¤ç›¸é—œæ´»å‹•çš„ç²¾å½©ç…§ç‰‡ à«®ê’°Ë¶à¸…ÌË˜à¸…Ì€Ë¶ê’±áƒ</p>
                </div>
                <div class="function-card" onclick="showPage('education')">
                    <i class="fas fa-apple-alt"></i>
                    <h3>ç‡Ÿé¤Šæ•™è‚²</h3>
                    <p>å­¸ç¿’å‡è¡¡é£²é£Ÿèˆ‡ç‡Ÿé¤ŠçŸ¥è­˜ à«®ê’° Ë¶â€¢ à¼ â€¢Ë¶ê’±áƒ</p>
                </div>
                <div class="function-card" onclick="showPage('subsidy')">
                    <i class="fas fa-file-contract"></i>
                    <h3>è£œåŠ©ç”³è«‹</h3>
                    <p>ä¸‹è¼‰èˆ‡ä¸Šå‚³åˆé¤è£œåŠ©ç”³è«‹æ–‡ä»¶</p>
                </div>
                <div class="function-card" onclick="showPage('finance')">
                    <i class="fas fa-calculator"></i>
                    <h3>æ”¶æ”¯çµç®—</h3>
                    <p>æŸ¥çœ‹åˆé¤ç¶“è²»æ”¶æ”¯çµç®—è¡¨</p>
                </div>
                <div class="function-card" onclick="showPage('lunch-coupon')">
                    <i class="fas fa-ticket-alt"></i>
                    <h3>å®‰å¿ƒåˆé¤åˆ¸</h3>
                    <p>ä¸‹è¼‰èˆ‡ç®¡ç†åˆé¤åˆ¸ç›¸é—œæ–‡ä»¶</p>
                </div>
				
            </div>
        </div>
	 <div class="announcements-container">
            <div class="announcement-header">
                <div class="header-icon">
                    <i class="fas fa-bullhorn"></i>
                </div>
                <h3>æœ€æ–°å…¬å‘Š</h3>
                <div class="header-decoration"></div>
            </div>
            
            <div class="announcement-list">
                <div class="announcement-item">
                    <div class="announcement-content">
                        <div class="announcement-dot"></div>
                        <span>9æœˆ1æ—¥èµ·åˆé¤å»šé¤˜æ¸›é‡è¨ˆç•«é–‹å§‹</span>
                    </div>
                    <span class="announcement-date">2025-09-1</span>
                </div>
                
                <div class="announcement-item">
                    <div class="announcement-content">
                        <div class="announcement-dot"></div>
                        <span>12345</span>
                    </div>
                    <span class="announcement-date">2023-05-08</span>
                </div>
                
                <div class="announcement-item">
                    <div class="announcement-content">
                        <div class="announcement-dot"></div>
                        <span>æœ¬å­¸æœŸåˆé¤è²»è²»è£œåŠ©ç”³è«‹å·²é–‹å§‹ï¼Œæˆªæ­¢æ—¥æœŸç‚º5æœˆ30æ—¥</span>
                    </div>
                    <span class="announcement-date">2023-05-05</span>
                </div>
                
                <div class="announcement-item">
                    <div class="announcement-content">
                        <div class="announcement-dot"></div>
                        <span>6æœˆèµ·å°‡å¯¦æ–½æ–°çš„åˆé¤ä¾›æ‡‰å•†è©•é‘‘åˆ¶åº¦</span>
                    </div>
                    <span class="announcement-date">2023-05-01</span>
                </div>
            </div>
            
            <div class="announcement-more">
                <a href="#" class="more-link">æŸ¥çœ‹å…¨éƒ¨å…¬å‘Š <i class="fas fa-chevron-right"></i></a>
            </div>
        </div>
    </div>

    <div id="menu" class="page-content">
        <div class="login-status">
            <span id="loginInfo">æœªç™»éŒ„</span>
            <button id="logoutBtn" class="logout-btn" style="display: none;" onclick="logout()">é€€å‡ºç™»éŒ„</button>
        </div>
        
        <h2 class="page-title"><i class="fas fa-utensils"></i> å» å•†èœå–® Ô…(Â¯ï¹ƒÂ¯Ô…)</h2>

        <center>
            <a href="https://drive.google.com/drive/folders/1p3fRv2eCKhkEVs-jCCLFEHezaZtmxMeI?usp=sharing" class="survey-button" target="_blank">
                <i class="fas fa-pencil-alt"></i> é›²ç«¯è³‡æ–™ä¸‹è¼‰è™•
            </a>
        </center>

        <div class="vendor-section">
            <h3 class="text-2xl font-bold mb-4">ç‰ç¾</h3>
            <div id="upload-section-1">
                <div class="upload-area" id="drop-area-1" onclick="handleUploadAreaClick(1)">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <h3>æ‹–æ›³Excelæˆ–CSVæª”æ¡ˆè‡³æ­¤ä¸Šå‚³æ›´æ–°èœå–®</h3>
                    <p class="text-gray-500 mt-2">æˆ–é»æ“Šæ­¤è™•é¸æ“‡æª”æ¡ˆ</p>
                    <input type="file" class="file-input" id="file-input-1" accept=".xlsx, .xls, .csv">
                </div>
                <div id="status-message-1" class="text-center mt-4 font-semibold text-gray-700"></div>
            </div>
            <div class="text-center">
                <button id="export-button-1" class="btn-export">åŒ¯å‡º Excel</button>
            </div>
            <div id="table-container-1" class="table-container" style="display: none;">
                <table id="data-table-1" class="excel-table rounded-lg shadow"></table>
            </div>
        </div>
        
        <hr class="my-8">

        <div class="vendor-section">
            <h3 class="text-2xl font-bold mb-4">é¦™è±ªä½³</h3>
            <div id="upload-section-2">
                <div class="upload-area" id="drop-area-2" onclick="handleUploadAreaClick(2)">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <h3>æ‹–æ›³Excelæˆ–CSVæª”æ¡ˆè‡³æ­¤ä¸Šå‚³æ›´æ–°èœå–®</h3>
                    <p class="text-gray-500 mt-2">æˆ–é»æ“Šæ­¤è™•é¸æ“‡æª”æ¡ˆ</p>
                    <input type="file" class="file-input" id="file-input-2" accept=".xlsx, .xls, .csv">
                </div>
                <div id="status-message-2" class="text-center mt-4 font-semibold text-gray-700"></div>
            </div>
            <div class="text-center">
                <button id="export-button-2" class="btn-export">åŒ¯å‡º Excel</button>
            </div>
            <div id="table-container-2" class="table-container" style="display: none;">
                <table id="data-table-2" class="excel-table rounded-lg shadow"></table>
            </div>
        </div>

        <hr class="my-8">

        <div class="vendor-section">
            <h3 class="text-2xl font-bold mb-4">æ½”é”</h3>
            <div id="upload-section-3">
                <div class="upload-area" id="drop-area-3" onclick="handleUploadAreaClick(3)">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <h3>æ‹–æ›³Excelæˆ–CSVæª”æ¡ˆè‡³æ­¤ä¸Šå‚³æ›´æ–°èœå–®</h3>
                    <p class="text-gray-500 mt-2">æˆ–é»æ“Šæ­¤è™•é¸æ“‡æª”æ¡ˆ</p>
                    <input type="file" class="file-input" id="file-input-3" accept=".xlsx, .xls, .csv">
                </div>
               <div id="status-message-3" class="text-center mt-4 font-semibold text-gray-700"></div>
            </div>
            <div class="text-center">
                <button id="export-button-3" class="btn-export">åŒ¯å‡º Excel</button>
            </div>
            <div id="table-container-3" class="table-container" style="display: none;">
                <table id="data-table-3" class="excel-table rounded-lg shadow"></table>
            </div>
        </div>

    </div>

   <div id="survey" class="page-content">
    <h2 class="page-title">åˆé¤æ»¿æ„åº¦èª¿æŸ¥</h2>
    <center>
        <p>è«‹é»æ“Šä¸‹æ–¹æŒ‰éˆ•å¡«å¯«æœ¬é€±çš„åˆé¤æ»¿æ„åº¦å•å·ï¼Œæ‚¨çš„æ„è¦‹å°æˆ‘å€‘éå¸¸é‡è¦ï¼ à¸…^â€¢Ï‰â€¢^à¸…</p>
        <a href="https://drive.google.com/drive/folders/13kufycRg2lY25sgKWWdC-NSdTV5qaTwu" class="survey-button" target="_blank">
            <i class="fas fa-pencil-alt"></i> å¡«å¯«å•å·
        </a>
        
        <!-- æ–°å¢çš„ç¬¬2é€±èª¿æŸ¥æŒ‰éˆ• -->
        <div style="margin-top: 20px;">
            <a href="https://docs.google.com/forms/d/e/1FAIpQLSeDo-kmRezAq8173z9bM2HI8nhHSrtzU-7N_BUL7NMZslP_tA/viewform" class="survey-button" target="_blank">
                <i class="fas fa-list-alt"></i> â—† 114-1åˆé¤æ»¿æ„åº¦-ç¬¬2é€±(09/08-09/12) â—†
            </a>
        </div>
		
		<div style="margin-top: 20px;">
            <a href="https://docs.google.com/forms/d/e/1FAIpQLSe1jPb0zrMYxe_UT4gbE4_8dyshs0bK-UTm-87-Q2uVlWcC-w/viewform" class="survey-button" target="_blank">
                <i class="fas fa-list-alt"></i> â—† 114-1åˆé¤æ»¿æ„åº¦-ç¬¬3é€±(09/15-09/19) â—†
            </a>
        </div>
		
		<div style="margin-top: 20px;">
            <a href="https://forms.gle/s9vToNLqcKTTeKt66" class="survey-button" target="_blank">
                <i class="fas fa-list-alt"></i> â—† 114-1åˆé¤æ»¿æ„åº¦-ç¬¬4é€±(09/22-09/26) â—†
            </a>
        </div>
		
		<div style="margin-top: 20px;">
            <a href="https://forms.gle/3eyyyF1dENtkEVho7" class="survey-button" target="_blank">
                <i class="fas fa-list-alt"></i> â—† 114-1åˆé¤æ»¿æ„åº¦-ç¬¬5é€±(09/29-10/03) â—†
            </a>
        </div>
		
		<div style="margin-top: 20px;">
            <a href="https://forms.gle/uhgiFqGpSUPFePgP7" class="survey-button" target="_blank">
                <i class="fas fa-list-alt"></i> â—† 114-1åˆé¤æ»¿æ„åº¦-ç¬¬6é€±(10/06-10/10) â—†
            </a>
        </div>
		
		<div style="margin-top: 20px;">
            <a href="https://forms.gle/Bz7kKfA6HSwzqmKQ8" class="survey-button" target="_blank">
                <i class="fas fa-list-alt"></i> â—† 114-1åˆé¤æ»¿æ„åº¦-ç¬¬7é€±(10/13-10/17) â—†
            </a>
        </div>
		
		<div style="margin-top: 20px;">
            <a href="https://forms.gle/Dv3k5XQ1CRxawn3U8" class="survey-button" target="_blank">
                <i class="fas fa-list-alt"></i> â—† 114-1åˆé¤æ»¿æ„åº¦-ç¬¬8é€±(10/20-10/24) â—†
            </a>
        </div>
		
		<div style="margin-top: 20px;">
            <a href="https://forms.gle/5KERdAjFyQhUkzQW6" class="survey-button" target="_blank">
                <i class="fas fa-list-alt"></i> â—† 114-1åˆé¤æ»¿æ„åº¦-ç¬¬9é€±(10/27-10/31) â—†
            </a>
        </div>
		
		<div style="margin-top: 20px;">
            <a href="https://forms.gle/tNWyASbbBs7u3zAi9" class="survey-button" target="_blank">
                <i class="fas fa-list-alt"></i> â—† 114-1åˆé¤æ»¿æ„åº¦-ç¬¬10é€±(11/03-11/07) â—†
            </a>
        </div>
		
		<div style="margin-top: 20px;">
            <a href="https://forms.gle/7aibyHtW3YGKCrAx6" class="survey-button" target="_blank">
                <i class="fas fa-list-alt"></i> â—† 114-1åˆé¤æ»¿æ„åº¦-ç¬¬11é€±(11/10-11/14) â—†
            </a>
        </div>
		
		<div style="margin-top: 20px;">
            <a href="https://forms.gle/VDRhmipFKwKWY84Y6" class="survey-button" target="_blank">
                <i class="fas fa-list-alt"></i> â—† 114-1åˆé¤æ»¿æ„åº¦-ç¬¬12é€±(11/17-11/21) â—†
            </a>
        </div>
		
		<div style="margin-top: 20px;">
            <a href="https://forms.gle/EEDxCe6mP9tqD7PD6" class="survey-button" target="_blank">
                <i class="fas fa-list-alt"></i> â—† 114-1åˆé¤æ»¿æ„åº¦-ç¬¬13é€±(11/24-11/28) â—†
            </a>
        </div>
		
		<div style="margin-top: 20px;">
            <a href="https://forms.gle/ynDG3SSbU6g9VRXeA" class="survey-button" target="_blank">
                <i class="fas fa-list-alt"></i> â—† 114-1åˆé¤æ»¿æ„åº¦-ç¬¬14é€±(12/01-12/05) â—†
            </a>
        </div>
		
		<div style="margin-top: 20px;">
            <a href="https://forms.gle/se6mbTZqUXGicjq4A" class="survey-button" target="_blank">
                <i class="fas fa-list-alt"></i> â—† 114-1åˆé¤æ»¿æ„åº¦-ç¬¬15é€±(12/08-12/12) â—†
            </a>
        </div>
		
		<div style="margin-top: 20px;">
            <a href="https://forms.gle/5g1TYw8Rb6aEdiTa9" class="survey-button" target="_blank">
                <i class="fas fa-list-alt"></i> â—† 114-1åˆé¤æ»¿æ„åº¦-ç¬¬16é€±(12/15-12/19) â—†
            </a>
        </div>
		
		<div style="margin-top: 20px;">
            <a href="https://forms.gle/QRH33phxFSF7XMub9" class="survey-button" target="_blank">
                <i class="fas fa-list-alt"></i> â—† 114-1åˆé¤æ»¿æ„åº¦-ç¬¬17é€±(12/22-12/26) â—†
            </a>
        </div>
		
		<div style="margin-top: 20px;">
            <a href="https://forms.gle/hjZPvSELare3Fx5w6" class="survey-button" target="_blank">
                <i class="fas fa-list-alt"></i> â—† 114-1åˆé¤æ»¿æ„åº¦-ç¬¬18é€±(12/29-01/02) â—†
            </a>
        </div>
		
		<div style="margin-top: 20px;">
            <a href="https://forms.gle/yoRZ2NnQKYuJ6tqU8" class="survey-button" target="_blank">
                <i class="fas fa-list-alt"></i> â—† 114-1åˆé¤æ»¿æ„åº¦-ç¬¬19é€±(01/05-01/09) â—†
            </a>
        </div>
		
		<div style="margin-top: 20px;">
            <a href="https://forms.gle/ej8GXswZqX8N6eNW9" class="survey-button" target="_blank">
                <i class="fas fa-list-alt"></i> â—† 114-1åˆé¤æ»¿æ„åº¦-ç¬¬20é€±(01/12-01/16) â—†
            </a>
        </div>
    </center>
</div>

    <div id="gallery" class="page-content">
        <h2 class="page-title">æ´»å‹•ç…§ç‰‡</h2>
        <div class="photo-gallery">
            <div class="photo-item"><img src="https://images.unsplash.com/photo-1542442434-d2e53ef781a7?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=400&q=80" alt="åˆé¤æ´»å‹•ç…§ç‰‡1"></div>
            <div class="photo-item"><img src="https://images.unsplash.com/photo-1579621970584-c81d86b6a655?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=400&q=80" alt="åˆé¤æ´»å‹•ç…§ç‰‡2"></div>
            <div class="photo-item"><img src="https://images.unsplash.com/photo-1578358897534-f2575a7c2f6d?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=400&q=80" alt="åˆé¤æ´»å‹•ç…§ç‰‡3"></div>
            <div class="photo-item"><img src="https://images.unsplash.com/photo-1620968940608-f1e16f3910c2?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=400&q=80" alt="åˆé¤æ´»å‹•ç…§ç‰‡4"></div>
            <div class="photo-item"><img src="https://images.unsplash.com/photo-1512621776951-a87f6cdb1807?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=400&q=80" alt="åˆé¤æ´»å‹•ç…§ç‰‡5"></div>
            <div class="photo-item"><img src="https://lh3.googleusercontent.com/H_ZhWRnpX6LV1ZVjX5zlR66HLJcPSzeYguDEckZQQyVIZrJJJMgzkcS_G49SVJmTlO7b91YwP0swhiR0oJ-qsfdKQvbY-opN-vVfArDp5MJyhXkNPvlsYxBK10BJT7MXkuzI9xjaqNIAqnti-FBLPblahzVsvnW0L-pRRhQBOswlOrC6slj-=w1280" alt="åˆé¤æ´»å‹•ç…§ç‰‡6"></div>
        </div>
    </div>

    <div id="education" class="page-content">
        <h2 class="page-title">ç‡Ÿé¤Šæ•™è‚²</h2>
        <style>
            .video-container {
                width: 560px;
                height: 315px;
                margin-bottom: 20px;
            }
            .upload-area {
                width: 560px;
                height: 180px;
                border: 2px dashed #666;
                border-radius: 8px;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                margin: 20px 0;
                cursor: pointer;
                transition: border-color 0.3s ease;
                background-color: #f9f9f9;
            }
            .upload-area:hover {
                border-color: #2c82c9;
            }
            .upload-area i {
                font-size: 36px;
                color: #666;
                margin-bottom: 10px;
            }
            .upload-area h3 {
                font-size: 50px;
                color: #333;
                margin: 0 0 8px 0;
                text-align: center;
                padding: 0 10px;
            }
            .upload-note {
                font-size: 14px;
                color: #888;
                margin: 0;
            }
            .uploaded-file-list {
                width: 560px;
                margin-top: 15px;
            }
            .uploaded-file-item {
                display: flex;
                align-items: center;
                padding: 10px;
                border-bottom: 1px solid #eee;
            }
            .uploaded-file-item i {
                font-size: 20px;
                color: #2c82c9;
                margin-right: 12px;
            }
            .uploaded-file-info h4 {
                margin: 0 0 5px 0;
                font-size: 15px;
            }
            .uploaded-file-path {
                font-size: 13px;
                color: #2c82c9;
                text-decoration: underline;
            }
            .uploaded-file-path:hover {
                color: #1a5d8c;
            }
            .erroræç¤º {
                color: #e74c3c;
                font-size: 14px;
                margin-top: 10px;
            }
        </style>
        
        <h3>â˜…å®£å°é£Ÿè¾²æ•™è‚²-ä¸‰ç« ä¸€Qæ¨™ç« ä»‹ç´¹â˜…</h3>
        <div class="video-container">
            <iframe width="560" height="315" src="https://www.youtube.com/embed/n_z659seHyY?si=187DuV_b7s-lKn89" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
        
        <h3>â˜…å°å—é£Ÿè¾²å±€-é£Ÿè¾²æ•™è‚²â˜…</h3>
        <div class="video-container">
            <iframe width="560" height="315" src="https://www.youtube.com/embed/YgOjNIREoUk?si=hhPzXQW0nBkvKAXf" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
        
        <h3>â˜…é™½å…‰æ¨‚è±†ä¹³æœ€æ£’!!â˜…</h3>
        <div class="video-container">
            <iframe width="560" height="315" src="https://www.youtube.com/embed/gBrQTIaYPI0?si=2M_YJBUKnqz0aG6c" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
        
        <h3>â˜…æ²’è¾²è—¥å°±æ˜¯æœ‰æ©Ÿ?æ‰æ²’é‚£éº¼ç°¡å–®!!!â˜…</h3>
        <div class="video-container">
            <iframe width="560" height="315" src="https://www.youtube.com/embed/XfhXAMth-F8?si=snJgeZkvkfOO75iC" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
        
        <h3>â˜…é¤æ¡Œä¸Šçš„é£Ÿç‰©ï¼Œä½ æœƒæ€éº¼é—œå¿ƒå‘¢?â˜…</h3>
        <div class="video-container">
            <iframe width="560" height="315" src="https://www.youtube.com/embed/gcB6uA7khgw?si=Qz1DIvEm5Eh1hnq8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
        
        <h3>â˜…å®œè˜­-é£Ÿè¾²æ•™è‚²é«”é©—è‡ªç„¶è¾²æ³•æ’ç§§æ”¶æˆâ˜…</h3>
        <div class="video-container">
            <iframe width="560" height="315" src="https://www.youtube.com/embed/19T72UeAp-4?si=5koOjbYWpfwDgqFh" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
        
        <h3>â˜…ä¸åƒéºµç²‰èº«é«”æœƒæ›´å¥½ï¼Ÿæ­ç¾è¶…å¤¯çš„ã€Œç„¡éº©è³ªé£²é£Ÿã€åˆ°åº•æ˜¯ä»€éº¼ï¼Ÿâ˜…</h3>
        <div class="video-container">
            <iframe width="560" height="315" src="https://www.youtube.com/embed/roYa64Fk2pU?si=Mp4b7iEkhijNuxCs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>

        <h3>â˜…å¥¶ç²¾åˆ°åº•æ˜¯ä»€éº¼ï¼Ÿå–æ—©é¤åº—å¤§å†°å¥¶æœƒæ‹‰è‚šå­ï¼Œæ˜¯å¥¶ç²¾å®³çš„å—ï¼Ÿâ˜…</h3>
        <div class="video-container">
            <iframe width="560" height="315" src="https://www.youtube.com/embed/FRCth5C6wvo?si=aXzVrkExEu1GiyIB" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>

        <h3>â˜…å‘³ç²¾æ›¾æ˜¯æœ€æ½®çš„èª¿å‘³æ–™ï¼Œç‚ºä½•å»è·Œè½ç¥å£‡ï¼Ÿé®®å‘³èƒŒå¾Œçš„èº«ä¸–ï¼Œå¯èƒ½æ¯”ä½ æƒ³çš„æ›´æ›²æŠ˜ï¼â˜…</h3>
        <div class="video-container">
            <iframe width="560" height="315" src="https://www.youtube.com/embed/wF7UdCb1RnA?si=qydaCns_nfHgPDdU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
        
        <h3>â˜…é­”èŠ‹çˆ½æ˜¯ç”šéº¼ï¼Ÿæˆåˆ†å¤§æ­ç§˜ï¼â˜…</h3>
        <div class="video-container">
            <iframe width="560" height="315" src="https://www.youtube.com/embed/4dvV6f6CgzY?si=m766DFz1dmsu7p2X" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
        
        <h3>â˜…æ³¨æ„å¥½XXå¶çˆ¾åƒä¸å±éšª?!åƒæ³¡éºµæœƒæ€æ¨£â˜…</h3>
        <div class="video-container">
            <iframe width="560" height="315" src="https://www.youtube.com/embed/mb2cW96Jae8?si=Y6pV2Wa_X22IBUSl" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>

        <center>
            <a href="https://drive.google.com/drive/folders/1p3fRv2eCKhkEVs-jCCLFEHezaZtmxMeI?usp=sharing" class="survey-button" target="_blank">
                <i class="fas fa-pencil-alt"></i> é›²ç«¯è³‡æ–™ä¸‹è¼‰è™•
            </a>
        </center>
    </div>

    <div id="subsidy" class="page-content">
        <h2 class="page-title">è£œåŠ©ç”³è«‹</h2>
        <p>è«‹ä¸‹è¼‰ç”³è«‹è¡¨æ ¼ï¼Œå¡«å¯«å®Œæˆå¾Œç¹³äº¤è‡³å­¸å‹™è™•åˆé¤ç§˜æ›¸ã€‚</p>
        <div class="file-list">
            <div class="file-item">
                <i class="fas fa-file-word"></i>
                <a href="https://drive.google.com/file/d/1bV9PN34vF867GJ3xKtoQgmitDvhRHGa-/view" download>113åŸä½æ°‘è£œåŠ©ç”³è«‹è¡¨.docx</a>
            </div>
            <div class="file-item">
                <i class="fas fa-file-word"></i>
                <a href="https://drive.google.com/file/d/1G_33mteM16ZZf9YlWw_BOKRgKmxf0t64/view" download>113æš‘ã€113-1å®‰å¿ƒé¤å·ç”³è«‹è¡¨.docx</a>
            </div>
            <div class="file-item">
                <i class="fas fa-file-word"></i>
                <a href="https://drive.google.com/file/d/1M9dguXQdb6P7bbAgHV6bae0R04RES-hB/view" download>113è²§å›°åˆé¤ç”³è«‹æ›¸.docx</a>
            </div>
            <div class="file-item">
                <i class="fas fa-file-word"></i>
                <a href="https://drive.google.com/file/d/1Omh2VduikQLvoAM2dHUF6nc4_i8NblUF/view" download>åˆé¤é€€è²»é€€é¤ç”³è«‹è¡¨.docx</a>
            </div>
        </div>
        <center>
            <a href="https://drive.google.com/drive/folders/1p3fRv2eCKhkEVs-jCCLFEHezaZtmxMeI?usp=sharing" class="survey-button" target="_blank">
                <i class="fas fa-pencil-alt"></i> é›²ç«¯è³‡æ–™ä¸‹è¼‰è™•
            </a>
        </center>
    </div>

    <div id="finance" class="page-content">
        <h2 class="page-title">æ”¶æ”¯çµç®—</h2>
        <p>è«‹é»æ“Šä»¥ä¸‹é€£çµæŸ¥çœ‹æœ¬å­¸æœŸåˆé¤æ”¶æ”¯çµç®—è¡¨ã€‚</p>
        <div class="file-list">
            <div class="file-item">
                <i class="fas fa-file-excel"></i>
                <a href="https://drive.google.com/file/d/1xvcCNQbhKm5XewZ6kB0PoGz2dArLEBXO/view" download>110å­¸å¹´åº¦ç¬¬ä¸€å­¸æœŸåˆé¤æ”¶æ”¯çµç®—è¡¨.pdf</a>
            </div>
            <div class="file-item">
                <i class="fas fa-file-excel"></i>
                <a href="https://drive.google.com/file/d/1ns2u0mkqfMKSF9IN3V840MXt-R6bRyyZ/view" download>110å­¸å¹´åº¦ç¬¬äºŒå­¸æœŸåˆé¤æ”¶æ”¯çµç®—è¡¨.pdf</a>
            </div>
            <div class="file-item">
                <i class="fas fa-file-excel"></i>
                <a href="https://drive.google.com/file/d/1OCDP2oqmRjft8fwYH_bZDWIdsA1hYjw_/view" download>111å­¸å¹´åº¦ç¬¬ä¸€å­¸æœŸåˆé¤æ”¶æ”¯çµç®—è¡¨.pdf</a>
            </div>
            <div class="file-item">
                <i class="fas fa-file-excel"></i>
                <a href="https://drive.google.com/file/d/1sUzq2_mGCIoBpuS8SDC5A2PcC13uuR6t/view" download>111å­¸å¹´åº¦ç¬¬äºŒå­¸æœŸåˆé¤æ”¶æ”¯çµç®—è¡¨.pdf</a>
            </div>
            <div class="file-item">
                <i class="fas fa-file-excel"></i>
                <a href="https://drive.google.com/file/d/1YL6uqmnjrE96teJ-icr0EBczKU0x2wh8/view" download>112å­¸å¹´åº¦ç¬¬ä¸€å­¸æœŸåˆé¤æ”¶æ”¯çµç®—è¡¨.pdf</a>
            </div>
            <div class="file-item">
                <i class="fas fa-file-excel"></i>
                <a href="https://drive.google.com/file/d/1-w6FloAk54v0mMgDx1QxXmiXfVOy1xRK/view" download>112å­¸å¹´åº¦ç¬¬äºŒå­¸æœŸåˆé¤æ”¶æ”¯çµç®—è¡¨.pdf</a>
            </div>
            <div class="file-item">
                <i class="fas fa-file-excel"></i>
                <a href="https://drive.google.com/file/d/108200WPhzqVtwwv0VXpvH9OdEljdupzM/view" download>113å­¸å¹´åº¦ç¬¬ä¸€å­¸æœŸåˆé¤æ”¶æ”¯çµç®—è¡¨.pdf</a>
            </div>
            <div class="file-item">
                <i class="fas fa-file-excel"></i>
                <a href="https://drive.google.com/file/d/1XKSgySzhbtKfsMkWlFkaeYAHQC4CwKrn/view" download>113å­¸å¹´åº¦ç¬¬äºŒå­¸æœŸåˆé¤æ”¶æ”¯çµç®—è¡¨.pdf</a>
            </div>
        </div>
        <center>
            <a href="https://drive.google.com/drive/folders/1p3fRv2eCKhkEVs-jCCLFEHezaZtmxMeI?usp=sharing" class="survey-button" target="_blank">
                <i class="fas fa-pencil-alt"></i> é›²ç«¯è³‡æ–™ä¸‹è¼‰è™•
            </a>
        </center>
    </div>

    <div id="lunch-coupon" class="page-content">
        <h2 class="page-title">å®‰å¿ƒåˆé¤åˆ¸</h2>
        <p>è«‹é»æ“Šä»¥ä¸‹é€£çµä¸‹è¼‰ç›¸é—œæ–‡ä»¶ã€‚</p>
        <div class="file-list">
            <div class="file-item">
                <i class="fas fa-file-pdf"></i>
                <a href="https://drive.google.com/file/d/1OfuVQ79WADu9rahmVsd5FEULxE5BdRFJ/view" download>è‡ºä¸­å¸‚å‡æ—¥å®‰å¿ƒåˆé¤åˆ¸èªªæ˜æ‰‹å†Š(è¶…å•†ç‰ˆ).pdf</a>
            </div>
            <div class="file-item">
                <i class="fas fa-file-pdf"></i>
                <a href="https://drive.google.com/file/d/1OX2jwY-ULqLw4AAQCgIgUfRj2dYYcmTz/view" download>è‡ºä¸­å¸‚å‡æ—¥å®‰å¿ƒåˆé¤åˆ¸(èªªæ˜æ‰‹å†Š).pdf</a>
            </div>
            <div class="file-item">
                <i class="fas fa-file-pdf"></i>
                <a href="https://vimeo.com/anchorfilm2017/review/854666173/a9e3d8f4d3" download>è‡ºä¸­å¸‚å‡æ—¥å®‰å¿ƒåˆé¤åˆ¸èªªæ˜æ‰‹å†Š(å½±ç‰‡ç‰ˆ)</a>
            </div>
        </div>
        <center>
            <a href="https://drive.google.com/drive/folders/1p3fRv2eCKhkEVs-jCCLFEHezaZtmxMeI?usp=sharing" class="survey-button" target="_blank">
                <i class="fas fa-pencil-alt"></i> é›²ç«¯è³‡æ–™ä¸‹è¼‰è™•
            </a>
        </center>
        <h3>å®‰å¿ƒåˆé¤å·7-11æ©Ÿå™¨å…Œæ›æ“ä½œä½¿ç”¨èªªæ˜</h3>
        <div class="video-container">
            <iframe width="560" height="315" src="https://www.youtube.com/embed/3cbPWvArWK8?si=hucdsQNOTI5qwTPp" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
        <h3>å®‰å¿ƒåˆé¤å·èŠçˆ¾å¯Œæ©Ÿå™¨å…Œæ›æ“ä½œä½¿ç”¨èªªæ˜</h3>
        <div class="video-container">
            <iframe width="560" height="315" src="https://www.youtube.com/embed/h9FCOGAfc7Q?si=G4bI5cOAyFgKyIZY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
        <h3>å®‰å¿ƒåˆé¤å…¨å®¶æ©Ÿå™¨å…Œæ›æ“ä½œä½¿ç”¨èªªæ˜</h3>
        <div class="video-container">
            <iframe width="560" height="315" src="https://www.youtube.com/embed/jllksCTYGIs?si=OmRsFudZ1RJqrVuD" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
        <h3>è£œå……èªªæ˜</h3>
        <div class="Text content">
            <p>ä¸€ã€è‡ºä¸­å¸‚å¯’æš‘å‡æš¨ä¾‹å‡æ—¥å®‰å¿ƒåˆé¤åˆ¸ æ•¸ä½å­¸ç”Ÿè­‰ é ˜é¤æµç¨‹åŠä½¿ç”¨èªªæ˜:</p>
            <p>â˜…â˜… å­¸ç”Ÿé ˜é¤æ™‚å‹™å¿…æ”œå¸¶æ•¸ä½å­¸ç”Ÿè­‰ï¼Œè‡ª114å¹´9æœˆ1æ—¥èµ·ï¼Œç‚ºéŸ¿æ‡‰ç’°ä¿ï¼Œå…Œé¤å…¨é¢å¯¦æ–½ç„¡ç´™åŒ–ï¼Œä¸å†åˆ—å°å°ç™½å–®ã€‚</p>
            <p>â˜…â˜… å­¸ç”ŸæŒæœ¬å¸‚æ•¸ä½å­¸ç”Ÿè­‰ï¼Œé¸å¥½é¤é»å¾Œè‡³æ«ƒæª¯æ„Ÿæ‡‰æ©Ÿå°å³å¯é ˜é¤ï¼Œè«‹å­¸ç”Ÿé…åˆè¾¦ç†ã€‚</p>
            <p>â˜…â˜… å€˜é‡å­¸ç”Ÿæ•¸ä½å­¸ç”Ÿè­‰æˆ–å¡ç‰‡æ•…éšœã€éºå¤±æˆ–å¿˜è¨˜æ”œå¸¶ç­‰æƒ…æ³ï¼Œè«‹æ–¼ç¾å ´å¡«å¯«ã€Œè‡ºä¸­å¸‚å®‰å¿ƒåˆé¤åˆ¸ è‡¨æ«ƒå…Œé¤è¡¨ã€ï¼Œä¸¦ä¾ä¸‹åˆ—æ–¹å¼ç”±è¶…å•†åº—å“¡æ‹ç…§å­˜æŸ¥å¾Œï¼Œå³å¯å…Œé¤ï¼š</p>
            <p>(1).æ•¸ä½å­¸ç”Ÿè­‰æˆ–å¡ç‰‡æ•…éšœè€…ï¼šè«‹å°‡å¡«å¦¥ä¹‹è¡¨å–®èˆ‡å¯¦é«”å¡ç‰‡ä¸€ä½µæ‹ç…§å­˜æŸ¥ã€‚</p>
            <p>(2).æ•¸ä½å­¸ç”Ÿè­‰æˆ–å¡ç‰‡éºå¤±æˆ–å¿˜è¨˜æ”œå¸¶è€…ï¼šåƒ…éœ€æ‹æ”å¡«å¦¥ä¹‹è¡¨å–®å³å¯ã€‚</p>
            <p>äºŒã€è«‹å‹™å¿…éµå®ˆã€è‡ºä¸­å¸‚å¯’æš‘å‡æš¨ä¾‹å‡æ—¥å®‰å¿ƒåˆé¤åˆ¸é ˜é¤å…§å®¹åŠä½¿ç”¨è¦ç¯„ã€‘è‹¥æŸ¥æœ‰ä¸ç•¶äº¤æ˜“æƒ…äº‹ï¼Œå°‡ä¾æ³•è¿½ç©¶è²¬ä»»ã€‚</p>
            <p>â˜…â˜… å€˜å¹³æ—¥ã€å¯’æš‘å‡åŠä¾‹å‡æ—¥ï¼Œå› é‡å¤©ç½(é¢±é¢¨)ç­‰ä¸å¯æŠ—åŠ›å› ç´ ï¼Œæœ¬å¸‚å®£å¸ƒåœæ­¢ä¸Šç­ä¸Šèª²ï¼Œå‰‡ç•¶æ—¥é ˜é¤æ™‚æ®µèª¿æ•´ç‚ºã€Œå…¨å¤©ã€(24å°æ™‚)çš†å¯è‡³ç«‹ç´„å» å•†é–€å¸‚é€²è¡Œå…Œé¤ã€‚â˜…â˜…</p>
            <p>â˜…â˜… å¯’æš‘å‡èª²ç…§å­¸ç”Ÿæ–¼ä¸Šèª²æ—¥é‡é¢±é¢¨å‡ä¹Ÿå¯ä»¥ç…§å¸¸è‡³è¶…å•†é ˜é¤ â˜…â˜…</p>
            <p>â˜…â˜… é¢±é¢¨å¤©å¤–å‡ºé ˜é¤è«‹å‹™å¿…ç•™æ„è‡ªèº«å®‰å…¨ â˜…â˜… é¢±é¢¨å¤©å¤–å‡ºé ˜é¤è«‹å‹™å¿…ç•™æ„è‡ªèº«å®‰å…¨ â˜…â˜…</p>
            <p>ä¸‰ã€</p>
            <p>â˜…â˜…â˜…â˜…â˜…æ•¸ä½å­¸ç”Ÿè­‰å¦‚éºå¤±è«‹ç«‹å³å‘ŠçŸ¥åˆé¤ç§˜æ›¸ä»¥ä¾¿å¾ŒçºŒæ“ä½œ</p>
            <p>å­¸ç”Ÿè­‰å¦‚éºå¤±è«‹è‡³æ­¤å®˜ç¶²é€²è¡Œè£œè¾¦å‹•ä½œ: https://stcard.tc.edu.tw/</p>
            <p>å››ã€å¦‚é ˜é¤æ“ä½œæµç¨‹æœ‰å•é¡Œï¼Œè«‹æ’¥æ‰“æ‚ éŠå¡24å°æ™‚å®¢æœå°ˆç·š:</p>
            <p>å…è²»å®¢æœå°ˆç·š  0800-028-880</p>
            <p>ä»˜è²»å®¢æœé›»è©± å¸‚è©±ç›´æ’¥ 412-8880</p>
            <p>æ‰‹æ©ŸåŠé‡‘é¦¬åœ°å€è«‹åŠ  02-4128880</p>
        </div>
    </div>

    <div id="loginModal" class="modal-overlay">
        <div class="modal-content">
            <h3>å» å•†ç™»éŒ„</h3>
            <div class="login-form">
                <div class="login-form-group">
                    <label for="username">ç”¨æˆ¶å</label>
                    <input type="text" id="username" placeholder="è«‹è¼¸å…¥ç”¨æˆ¶å">
                </div>
                <div class="login-form-group">
                    <label for="password">å¯†ç¢¼</label>
                    <input type="password" id="password" placeholder="è«‹è¼¸å…¥å¯†ç¢¼">
                </div>
                <div id="loginError"> ç”¨æˆ¶åæˆ–å¯†ç¢¼éŒ¯èª¤ï¼Œè«‹é‡æ–°è¼¸å…¥ </div>
                <button onclick="checkLogin()">ç™»éŒ„</button>
            </div>
        </div>
    </div>

    <script>
        // é¡µé¢åˆ‡æ¢åŠŸèƒ½
        function showPage(pageId) {
            // éšè—æ‰€æœ‰é¡µé¢
            document.querySelectorAll('.page-content').forEach(page => {
                page.style.display = 'none';
            });
            // æ˜¾ç¤ºé€‰ä¸­çš„é¡µé¢
            document.getElementById(pageId).style.display = 'block';
            // å¦‚æœæ˜¾ç¤ºçš„æ˜¯èœå•é¡µé¢ï¼Œæ›´æ–°ç™»å½•çŠ¶æ€æ˜¾ç¤º
            if (pageId === 'menu') {
                updateLoginStatus();
            }
        }

        // åˆå§‹æ˜¾ç¤ºé¦–é¡µ
        document.addEventListener('DOMContentLoaded', function() {
            showPage('home');
            initLoginState();
            setupUploaders();
            loadSavedData();
        });

        // ç™»å½•ç›¸å…³å˜é‡å’Œå‡½æ•°
        let isLoggedIn = false;
        let currentUser = null;
        let currentVendorId = null; // å½“å‰ç™»å½•å‚å•†ID

        // å‚å•†è´¦å·ä¿¡æ¯ (å®é™…åº”ç”¨ä¸­åº”ä»æœåŠ¡å™¨éªŒè¯)
        const vendorAccounts = [
            { id: 1, username: 'yumei', password: 'yumei123', name: 'ç‰ç¾ç®¡ç†å“¡' },
            { id: 2, username: 'xianghaojia', password: 'xiang123', name: 'é¦™è±ªä½³ç®¡ç†å“¡' },
            { id: 3, username: 'jieda', password: 'jieda123', name: 'æ½”é”ç®¡ç†å“¡' },
            { id: 0, username: 'inphoon', password: '26992028', name: 'ç¸½ç®¡ç†å“¡' } // ç®¡ç†å‘˜å¯ä»¥æ“ä½œæ‰€æœ‰å‚å•†
        ];

        // åˆå§‹åŒ–ç™»å½•çŠ¶æ€
        function initLoginState() {
            const savedLogin = localStorage.getItem('lunchVendorLogin');
            if (savedLogin) {
                const loginData = JSON.parse(savedLogin);
                isLoggedIn = true;
                currentUser = loginData.username;
                currentVendorId = loginData.vendorId;
            }
        }

        // æ˜¾ç¤ºç™»å½•æ¨¡æ€æ¡†
        function showLoginModal() {
            document.getElementById('loginModal').classList.add('visible');
        }

        // éšè—ç™»å½•æ¨¡æ€æ¡†
        function hideLoginModal() {
            document.getElementById('loginModal').classList.remove('visible');
            document.getElementById('loginError').style.display = 'none';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        }

        // æ£€æŸ¥ç™»å½•
        function checkLogin() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            const user = vendorAccounts.find(u => u.username === username && u.password === password);
            if (user) {
                isLoggedIn = true;
                currentUser = user.name;
                currentVendorId = user.id;
                // ä¿å­˜ç™»å½•çŠ¶æ€
                localStorage.setItem('lunchVendorLogin', JSON.stringify({ username: user.name, vendorId: user.id, loginTime: new Date().toISOString() }));
                updateLoginStatus();
                hideLoginModal();
                updateUploadAreaState();
                alert(`ç™»éŒ„æˆåŠŸï¼æ­¡è¿ï¼Œ${user.name}å» å•†`);
            } else {
                document.getElementById('loginError').style.display = 'block';
            }
        }

        // æ›´æ–°ç™»å½•çŠ¶æ€æ˜¾ç¤º
        function updateLoginStatus() {
            const loginInfo = document.getElementById('loginInfo');
            const logoutBtn = document.getElementById('logoutBtn');
            if (isLoggedIn && currentUser) {
                loginInfo.textContent = `ç•¶å‰ç™»éŒ„ï¼š${currentUser}`;
                logoutBtn.style.display = 'inline-block';
            } else {
                loginInfo.textContent = 'æœªç™»éŒ„';
                logoutBtn.style.display = 'none';
            }
        }

        // é€€å‡ºç™»å½•
        function logout() {
            isLoggedIn = false;
            currentUser = null;
            currentVendorId = null;
            localStorage.removeItem('lunchVendorLogin');
            updateLoginStatus();
            updateUploadAreaState();
            alert('å·²æˆåŠŸé€€å‡ºç™»éŒ„');
        }

        // æ›´æ–°ä¸Šå‚³å€åŸŸç‹€æ…‹ï¼ˆå•Ÿç”¨/ç¦ç”¨ï¼‰
        function updateUploadAreaState() {
            for (let i = 1; i <= 3; i++) {
                const dropArea = document.getElementById(`drop-area-${i}`);
                const inputField = document.getElementById(`file-input-${i}`);
                const vendorId = i;

                if (isLoggedIn && (currentVendorId === 0 || currentVendorId === vendorId)) {
                    // å¦‚æœå·²ç™»å…¥ä¸”æœ‰æ¬Šé™
                    dropArea.classList.remove('disabled');
                    dropArea.onclick = () => handleUploadAreaClick(vendorId);
                    inputField.disabled = false;
                } else {
                    // å¦‚æœæœªç™»å…¥æˆ–ç„¡æ¬Šé™
                    dropArea.classList.add('disabled');
                    dropArea.onclick = () => handleUploadAreaClick(vendorId);
                    inputField.disabled = true;
                }
            }
        }

        // å¤„ç†ä¸Šä¼ åŒºåŸŸç‚¹å‡»
        function handleUploadAreaClick(vendorId) {
            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            if (!isLoggedIn) {
                showLoginModal();
                return;
            }
            // æ£€æŸ¥æƒé™ (ç®¡ç†å‘˜å¯ä»¥æ“ä½œæ‰€æœ‰ï¼Œå‚å•†åªèƒ½æ“ä½œè‡ªå·±çš„)
            if (currentVendorId !== 0 && currentVendorId !== vendorId) {
                alert('æ‚¨æ²’æœ‰æ¬Šé™ä¸Šå‚³æ­¤å» å•†çš„èœå–®');
                return;
            }
            // è§¦å‘æ–‡ä»¶é€‰æ‹©
            document.getElementById(`file-input-${vendorId}`).click();
        }

        // è®¾ç½®ä¸Šä¼ åŠŸèƒ½
        function setupUploaders() {
            for (let i = 1; i <= 3; i++) {
                setupUploader(i);
            }
        }

        const uploaders = {};
        function setupUploader(index) {
            const uploader = {};
            uploader.dropArea = document.getElementById(`drop-area-${index}`);
            uploader.fileInput = document.getElementById(`file-input-${index}`);
            uploader.statusMessage = document.getElementById(`status-message-${index}`);
            uploader.tableContainer = document.getElementById(`table-container-${index}`);
            uploader.dataTable = document.getElementById(`data-table-${index}`);
            uploader.exportButton = document.getElementById(`export-button-${index}`);
            uploader.currentWorkbook = null;

            // å¤„ç†æ‹–æ”¾äº‹ä»¶
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                uploader.dropArea.addEventListener(eventName, (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                });
            });

            uploader.dropArea.addEventListener('drop', (e) => {
                if (!isLoggedIn || (currentVendorId !== 0 && currentVendorId !== index)) {
                    alert('è«‹å…ˆç™»éŒ„ä¸¦ç¢ºèªæ‚¨æœ‰æ¬Šé™é€²è¡Œæ­¤æ“ä½œ');
                    return;
                }
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFile(files[0], index);
                }
            });

            uploader.fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleFile(e.target.files[0], index);
                }
            });

            uploader.exportButton.addEventListener('click', () => {
                if (uploaders[index].currentWorkbook) {
                    exportFile(uploaders[index].currentWorkbook, index);
                }
            });

            uploaders[index] = uploader;
        }

        // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
        function handleFile(file, index) {
            const uploader = uploaders[index];
            uploader.statusMessage.textContent = `æ­£åœ¨è®€å–æª”æ¡ˆ: ${file.name}...`;
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    uploader.currentWorkbook = workbook;
                    const firstSheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[firstSheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                    if (jsonData.length > 0) {
                        uploader.statusMessage.textContent = `æª”æ¡ˆã€Œ${file.name}ã€è®€å–æˆåŠŸï¼`;
                        renderTable(jsonData, index);
                        uploader.exportButton.style.display = 'inline-block';
                        // å°‡è³‡æ–™å­˜å…¥ localStorage
                        localStorage.setItem(`vendorData_${index}`, JSON.stringify(jsonData));
                    } else {
                        uploader.statusMessage.textContent = `æª”æ¡ˆã€Œ${file.name}ã€å…§å®¹ç‚ºç©ºã€‚`;
                        uploader.tableContainer.style.display = 'none';
                        uploader.exportButton.style.display = 'none';
                        localStorage.removeItem(`vendorData_${index}`);
                    }
                } catch (error) {
                    console.error("è™•ç†æª”æ¡ˆæ™‚ç™¼ç”ŸéŒ¯èª¤:", error);
                    uploader.statusMessage.textContent = `è®€å–æª”æ¡ˆæ™‚ç™¼ç”ŸéŒ¯èª¤ã€‚è«‹ç¢ºèªæ‚¨ä¸Šå‚³çš„æ˜¯æœ‰æ•ˆçš„ Excel æˆ– CSV æª”æ¡ˆã€‚`;
                    uploader.tableContainer.style.display = 'none';
                    uploader.exportButton.style.display = 'none';
                    localStorage.removeItem(`vendorData_${index}`);
                }
            };
            reader.readAsArrayBuffer(file);
        }

        // æ¸²æŸ“è¡¨æ ¼
        function renderTable(data, index) {
            const uploader = uploaders[index];
            uploader.dataTable.innerHTML = '';
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            if (data[0] && data[0].length > 0) {
                data[0].forEach(headerText => {
                    const th = document.createElement('th');
                    th.textContent = headerText;
                    headerRow.appendChild(th);
                });
                thead.appendChild(headerRow);
                uploader.dataTable.appendChild(thead);
            }

            const tbody = document.createElement('tbody');
            for (let i = 1; i < data.length; i++) {
                const rowData = data[i];
                if (rowData && rowData.length > 0) {
                    const tr = document.createElement('tr');
                    rowData.forEach(cellData => {
                        const td = document.createElement('td');
                        td.textContent = cellData;
                        tr.appendChild(td);
                    });
                    tbody.appendChild(tr);
                }
            }
            uploader.dataTable.appendChild(tbody);
            uploader.tableContainer.style.display = 'block';
        }

        // å¯¼å‡ºæ–‡ä»¶
        function exportFile(workbook, index) {
            const wbout = XLSX.write(workbook, { bookType: 'xlsx', type: 'array' });
            saveAs(new Blob([wbout], { type: 'application/octet-stream' }), `å» å•†èœå–®_${index}.xlsx`);
        }

        // ä¿å­˜æ–‡ä»¶è¾…åŠ©å‡½æ•°
        function saveAs(obj, fileName) {
            const a = document.createElement('a');
            a.download = fileName;
            a.href = URL.createObjectURL(obj);
            a.click();
            setTimeout(() => {
                URL.revokeObjectURL(a.href);
            }, 0);
        }

        // è¼‰å…¥å·²å„²å­˜è³‡æ–™
        function loadSavedData() {
            for (let i = 1; i <= 3; i++) {
                const uploader = uploaders[i];
                const savedData = localStorage.getItem(`vendorData_${i}`);
                if (savedData) {
                    const jsonData = JSON.parse(savedData);
                    if (jsonData && jsonData.length > 0) {
                        renderTable(jsonData, i);
                        uploader.tableContainer.style.display = 'block';
                        uploader.exportButton.style.display = 'inline-block';
                        uploader.statusMessage.textContent = `å·²è¼‰å…¥ä¸Šæ¬¡å„²å­˜çš„èœå–®ã€‚`;
                        
                        const ws = XLSX.utils.aoa_to_sheet(jsonData);
                        const wb = XLSX.utils.book_new();
                        XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
                        uploader.currentWorkbook = wb;
                    }
                }
            }
        }
    </script>

    <!-- é å°¾ -->
    <footer style="text-align: center; padding: 20px; margin-top: 30px; border-top: 1px solid #eee;">
        Â© 2025 å¤§é“åœ‹ä¸­ åˆé¤è³‡è¨Šç³»çµ± | é›»è©±: (04) 2699-2028 | åœ°å€: è‡ºä¸­å¸‚å¤§è‚šå€å¤§æ±é‡Œä»å¾·è·¯60è™Ÿ | å‚³çœŸï¼š04-26980970
    </footer>
</body>
</html>
